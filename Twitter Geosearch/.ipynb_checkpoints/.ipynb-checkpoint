{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from TwitterAPI import TwitterAPI\n",
    "from TwitterAPI import TwitterPager\n",
    "import json\n",
    "import pandas as pd\n",
    "import time\n",
    "\n",
    "###FULL ARCHIVE KEYS\n",
    "# api = TwitterAPI(consumer_key = 'WBi5cw4Fahq8nhorYcIwJ8TOy',\n",
    "#                 consumer_secret = 'ezBNO3v3TmJxm2ESvzrZPEfht6aFtEUHS6S9i8pDhJ159t5odK',\n",
    "#                 access_token_key = '1582827440-ShN1QU8qg2ZllL8TUv64edfLGtNpT8SsCBdFtPb',\n",
    "#                 access_token_secret = '6ceCQAmdyNHdTBVBXQsBKEzSFpX5MyHKQVzt9SU6yfLvg')\n",
    "\n",
    "##30 DAY KEYS\n",
    "api = TwitterAPI(consumer_key = 'r1NRvjJgmsFlCashfOcRzaUAA',\n",
    "                 consumer_secret = '5LvQfwrnsCdwzScxcffKujq4R41gJQwO0DpifcqND7M6OPG12Y',\n",
    "                 access_token_key = '1582827440-gaQnkTMyGolC5l9VY5ieFeh8Btqg85dxLdC1VSY',\n",
    "                 access_token_secret = 'FfpwmcXfPDjZlsXasvSKwnp6MSFGNzJ6zQdEq69376RWR')\n",
    "\n",
    "##DEV ENVIRONMENT\n",
    "PRODUCT = '30day'\n",
    "#PRODUCT = 'fullarchive'\n",
    "LABEL = 'Research'\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2 #custommade #countdowntoNas #lookformeatCanalside 8.30.19 @ Canalside Live Concert Series https://t.co/pljP71AzvT\n",
      "3 Long weekend vibes üëó‚òÄÔ∏èüòäüëª‚ù§Ô∏è @ Buffalo Waterfront https://t.co/btqG7TNCRw\n",
      "4 @sociald1 @mikeness @ Canalside Live Concert Series https://t.co/BfTHLNgKn7\n",
      "5 @floggingmolly @ Canalside Live Concert Series https://t.co/g9U3gdtSFZ\n",
      "6 @floggingmolly @ Canalside Live Concert Series https://t.co/6VZ8wt0VRY\n",
      "7 #TheDevilMakesThree @thedevilmakes3 djheppel68 @ Canalside Live Concert Series https://t.co/DM78t5uSC9\n",
      "8 @buffalolibrary Library on Wheels is at EPIC story time at Canalside! https://t.co/6vLfZVmosG\n",
      "9 Fun in the rain buffalowaterfront \n",
      "@floggingmolly. #floggingmolly #justsayingbuffalo üòÅüåßüòÅ @ Buffalo Waterfront https://t.co/YN3TcVWrVl\n",
      "10 HAPPINESS BEGINS https://t.co/k5eCtJCsxf\n",
      "11 MAKE AMERICA GREAT AGAIN. I wish I had recorded the awkward silence as he let the crowd stew on the point he was ma‚Ä¶ https://t.co/3DOqeIFnaS\n",
      "12 Great road trip to see Social D! @sociald1  Good time had by all. Bonus was no border wait and the venue was servin‚Ä¶ https://t.co/w3NsCiFffF\n",
      "13 When you decide on a whim to buy a ticket to knock another band off your list and stay until they play your fave so‚Ä¶ https://t.co/i3WqwLVEl3\n",
      "14 Concert drunk on a Tuesday night ü§∑üèª‚Äç‚ôÄÔ∏è https://t.co/TwI5xduraZ\n",
      "15 #floggingmolly @ Canalside Live Concert Series https://t.co/oFKPVf7gG3\n",
      "16 Drinking a Westward by @ThinManBrewery at @libertyhoundbuf ‚Äî https://t.co/yhtBfuryel\n",
      "17 I'm at Canalside for Social Distortion in Buffalo, NY https://t.co/By4WVd4vxM\n",
      "18 #SocialDistortion #FloggingMolly @ canalside\n",
      "19 Free beer= start strong - Drinking a Hayburner by @bigditchbrewing at @canalsidebflo  ‚Äî https://t.co/5Xa4IJYbUu\n",
      "20 I'm at Explore &amp; More - The Ralph C. Wilson, Jr. Children's Museum - @exploremore716 in Buffalo, NY https://t.co/bU4la5Tcet\n",
      "21 I'm at @CanalsideBflo in Buffalo, NY https://t.co/CYLP6fHbll\n",
      "22 These nachos were real good https://t.co/seaenc48EL\n",
      "23 He hung up the French Fry Skillsets for another year; now he is working the Water Taxi in Canalside for a few weeks‚Ä¶ https://t.co/k9wgqssGfO\n",
      "24 Summer time fun üíúüíô Talia‚Äôs dress from tinyrufflesboutique ‚Ä¢\n",
      "‚Ä¢\n",
      "‚Ä¢\n",
      "‚Ä¢\n",
      "#taliatales #jedijace #summer #disneybaby‚Ä¶ https://t.co/uhtOeDoRWk\n",
      "25 BUFFALOVE ‚ù§Ô∏èüíô‚ù§Ô∏èüíô @ Buffalo Waterfront https://t.co/uAEpREwKzt\n",
      "26 ~views~ https://t.co/luTmPQeSDw\n",
      "27 #summerday ...\n",
      "\n",
      "üì∏ https://t.co/5Ixl0Ft5H3 https://t.co/3I8dO3B4r5\n",
      "28 Closing out our #buffalove #summer day with the one and only @sharkgirlbflo. A great day to be a hometown tourist! https://t.co/2PgyiXalRQ\n",
      "29 Paddle #boating at Canalside! @waterbikesbuff #buffalove #summer https://t.co/8Cg7xC09PZ\n",
      "30 We are privately chartered this evening but we still have two opportunities to cruise with us tomorrow. Join us for‚Ä¶ https://t.co/6heEAcG8Xv\n",
      "31 Canalside on a Saturday https://t.co/hCY6Zh7JDl\n",
      "32 Next stop: @exploremore716! #buffalove #summer https://t.co/qS55Kh7qVN\n",
      "33 We have several boats purpose built for alcohol consumption!\n",
      "\n",
      "#buffalo https://t.co/Pedoj5p2HI\n",
      "34 Mac &amp; Cheese crunch rolls üòç https://t.co/WlhHdDMp2E\n",
      "35 I'm at Queen City Bike Ferry in Buffalo, NY https://t.co/xyVFr8STnw\n",
      "36 I'm at @LibertyHoundBuf in Buffalo, NY https://t.co/I7AAs3mtSn\n",
      "37 Just posted a photo @ Shark Girl https://t.co/y06YQpJfOT\n",
      "38 summer fun on bike paddle boat!!! \n",
      "#justsayingbuffalo #canalsidebuffalo \n",
      "canalsidebuffalofanpage @ Buffalo Waterfro‚Ä¶ https://t.co/mKgdvC2O2l\n",
      "39 8.15.19 #Drawing: Commercial Slip in Buffalo‚Äôs Canalside where the Buffalo Creek was excavated for the terminus of‚Ä¶ https://t.co/upzzzc6LYn\n",
      "40 This weekend we visited the Buffalo Naval and Military Park and Canalside on the Buffalo Waterfront. This weekend w‚Ä¶ https://t.co/XqjoeTzeBQ\n",
      "41 oooh it Just got hot in HEERRRE!!!!! THREE-time #GrammyAwards winner @Nelly_Mo hit the stage in Bufalo NY at‚Ä¶ https://t.co/4phUJ7sEIa\n",
      "42 Visited #sharkgirl in Canal Side in Buffalo! #travels #traveler #buffalo #newyork #buffalony #family #familytime‚Ä¶ https://t.co/WYk40YeV1N\n",
      "43 Visited #sharkgirl in Canal Side in Buffalo! #travels #traveler #buffalo #newyork #buffalony #family #familytime‚Ä¶ https://t.co/UnQXKW8ghB\n",
      "44 Love those August pro skates at @Harborctr ! @AcademyOfHockey https://t.co/2BsjxNqP2u\n",
      "45 Shared my birthday at the @Nelly_Mo concert saturday with these beautiful people... had a blast @ Canalside Live Co‚Ä¶ https://t.co/TtgicyBMpu\n",
      "46 Local musician and rapper, Dom Brown and friends, perform as the opening act for Nelly, at Canalside Live, in Buffa‚Ä¶ https://t.co/D834KFsFC8\n",
      "47 I was kind of feeling myself yesterday lol #bmdc #blackmendontcheat #SojournerSaidItSoItsTrue https://t.co/2j1olncJnU\n",
      "48 I'm at @LibertyHoundBuf in Buffalo, NY https://t.co/dOQkSBicvU\n",
      "49 I'm at @CanalsideBflo in Buffalo, NY https://t.co/56lkVOlBfl https://t.co/nyUAhpI1Z3\n",
      "50 My birthday went a little something like this @ Canalside Live Concert Series https://t.co/lhq29o673e\n",
      "51 @Nelly_Mo #Buffalo #Nelly #CanalsideBuffalo https://t.co/vHo0KIqOh5\n",
      "52 Just posted a photo @ Canalside Live Concert Series https://t.co/cfOi7zXc19\n",
      "53 Just posted a photo @ Canalside Live Concert Series https://t.co/8vozBVM4vG\n",
      "54 Just out here trying to live my best life üíÉüèº #summertime #nellyatcanalside  üì∏: bbonfante @ Canalside Live Concert S‚Ä¶ https://t.co/4BxtUCSrzw\n",
      "55 Where TF in BuffaloNY is #Nelly at!  its time Dude! HIT THE STAGE! https://t.co/AipK5gb8k5 https://t.co/1AdQ3iDEuW‚Ä¶ https://t.co/Jho6cxe8Nx\n",
      "56 Just posted a photo @ Canalside Live Concert Series https://t.co/DPixbRaKKE\n",
      "57 Pre- @Nelly_Mo #Buffalo #Nelly https://t.co/cdqIdEiQKh\n",
      "58 Congratulations Dom! @ Canalside Live Concert Series https://t.co/fbmdGCnJnY\n",
      "59 @DomBrown___\n",
      "\n",
      "Dom Brown and myself down at Canalside Buffalo!!  He will be the opener tonight before Nelly. What a‚Ä¶ https://t.co/2iBVnrIcfP\n",
      "60 Ready for the Nelly Concert @ Canalside Live Concert Series https://t.co/YEOuXq17IQ\n",
      "61 https://t.co/qYDhLiK5zu\n",
      "62 Best night EVER!!!\n",
      "THANK YOU  @mybrandonboyd \n",
      "#incubus #vip #frontofstage #buffalove #drive #canalsidebuffalo‚Ä¶ https://t.co/K8KqVZxUwp\n",
      "63 Random dude behind me that wanted a pic. No idea, but it‚Äôs #Buffalo so I‚Äôm sure I know someone who knows him üòã‚Ä¶ https://t.co/Z1D2dvB22x\n",
      "64 @IncubusBand #Incubus #CanalsideBuffalo #Buffalo https://t.co/zd7OXZ74qX\n",
      "65 Nice night and out in downtown #Buffalo with friends.  Only knew like 5 songs but thought @IncubusBand put on a pre‚Ä¶ https://t.co/2rBVxanbwq\n",
      "66 Wish you were here üé∂ @ Canalside Live Concert Series https://t.co/xWS1JRJyHA\n",
      "67 #incubus @ Canalside Live Concert Series https://t.co/B7JpODqJn9\n",
      "68 I'm at @CanalsideBflo in Buffalo, NY https://t.co/n4JlQVrHT6\n",
      "69 Incubus! - Drinking a Hayburner by @bigditchbrewing at @canalsidebflo  ‚Äî https://t.co/QtXDXdbDPE\n",
      "70 This girl gets more photo requests than @sharkgirlbflo @BentleyRadio @1033TheEdge https://t.co/8vSSmrOdt5\n",
      "71 @jjwildechild good stuff at Canalside!\n",
      "72 Even #Constructicons have bring your kid to work day. #Transformers #Decepticons  #Incubus @ Canalside Live Concert‚Ä¶ https://t.co/pkXHMOY3F9\n",
      "73 Drinking a Blue Citra by Labatt Brewing Company @ Canalside Beer Garden ‚Äî https://t.co/AvJ9ArRh5J\n",
      "74 I'm at Canalside for Incubus in Buffalo, NY https://t.co/CRmDQ6fiB6\n",
      "75 üòç (at @CanalsideBflo for Incubus in Buffalo, NY w/ @wildhomesroc) https://t.co/nsEK6cyvcS\n",
      "76 Drinking an After-Sesh Ale by @CigarCityBeer at @libertyhoundbuf ‚Äî https://t.co/ZM6cKYyyoL\n",
      "77 @MikeonMuch Here‚Äôs my best picture from Greg‚Äôs big moment. https://t.co/qhSEOCXJJX https://t.co/z3Zcriexa6\n",
      "78 I think that the lighting in this picture really adds to the mystique of the keytar. https://t.co/PqH5h439nZ\n",
      "79 Great to be a part of Hamilton‚Äôs invasion of Canalside with thedirtynil and @arkellsmusic  #thedirtynil‚Ä¶ https://t.co/ItnkS0GU8Z\n",
      "80 Great to be a part of Hamilton‚Äôs invasion of Canalside with thedirtynil and @arkellsmusic   #hamiltonrocks‚Ä¶ https://t.co/n5x6UFYvwl\n",
      "81 Great music + warm summer night + fun friends = a perfect night dancing with @arkellsmusic in #Buffalo! @Roso1978‚Ä¶ https://t.co/1mBtetOdYz\n",
      "82 First and definitely not the last @arkellsmusic concert! Just an amazing time with @kerratriv!! #buffalove‚Ä¶ https://t.co/ndgNkouJAz\n",
      "83 For the @MikeonMuch fans out there: here‚Äôs Mike‚Äôs brother Greg playing guitar on Private School tonight in Buffalo. https://t.co/hSS2QEma1d\n",
      "84 Thank you @arkellsmusic and @Max_Kerman for making this the best night of mine and @rachel_radice lives ü•∞üôè https://t.co/VwKsRhkjEM\n",
      "85 Arkells, again. ü§òüèª‚ù§Ô∏è @ Canalside Live Concert Series https://t.co/zG90tvSLIg\n",
      "86 This. Thank you Buffalo. Arkells. ‚ù§Ô∏è\n",
      ".\n",
      ".\n",
      ".\n",
      ".\n",
      ".\n",
      "#buffalo #arkells #musicfestival #arkells @ Canalside Live Concert S‚Ä¶ https://t.co/srNlZE7wGI\n",
      "87 Arkells - Drinking a Hayburner by @bigditchbrewing at @canalsidebflo  ‚Äî https://t.co/KMYfar59SQ\n",
      "88 ‚ö°@arkellsmusic with my faaaave @ouiouiandie! üéµ (@ Canalside in Buffalo, NY) https://t.co/8YZAQcoRfU\n",
      "89 truly, a great day (yes, my tag is out )|| ‚òÄÔ∏èüåä @ Buffalo Waterfront https://t.co/vNMzCz3ih9\n",
      "90 @arkellsmusic we can wait in this lovely @BufWaterfront for a couple hours! Stretching and getting ready to shake a leg!\n",
      "91 We made it! A perfect day at Canalside to enjoy thedirtynil and @arkellsmusic #thedirtynil #arkells #hamiltonrocks‚Ä¶ https://t.co/xnQN0LSQv2\n",
      "92 Looking for a bite to eat this beautiful Friday? We‚Äôre open at The Buffalo and Erie County Naval and Military Park‚Ä¶ https://t.co/H2C6pFEqhZ\n",
      "93 It's a lovely day at Canalside https://t.co/rF3xcF9N3O\n",
      "94 Are you free this Saturday? If not come visit our booth at the Buffalo Science Festival at Canalside! We'll be doin‚Ä¶ https://t.co/in1tY3D5bz\n",
      "95 Don't forget to Get Your Tickets for the @Nelly_Mo  concert#1K_Simmons 844.487.3846\n",
      "https://t.co/M4jTll6BXd‚Ä¶ https://t.co/rKY4GhLUgV\n",
      "96 Drinking a Labatt Blue Light Grapefruit by Labatt Brewing Company at @canalsidebflo ‚Äî https://t.co/8v8mjcZuDL\n",
      "97 Drinking an 1911 Hard Cider by @1911Spirits at @canalsidebflo ‚Äî https://t.co/melnnUvXMR\n",
      "98 #wcw RMRüíô 17 days til you‚Äôre two. Am I the only mom who cries like once a day leading to your babies birthday? Wher‚Ä¶ https://t.co/A4m16PyIZa\n"
     ]
    }
   ],
   "source": [
    "##BOUNDING BOXES: from https://boundingbox.klokantech.com/ format:csv\n",
    "##NYC: bounding_box:[-74.135353 40.635674 -73.801643 40.893625]\n",
    "##Canalside: bounding_box:[-78.8797905618,42.8756162086,-78.8774945908,42.8791227573]\n",
    "\n",
    "\n",
    "##TWEET ITERATOR\n",
    "r = TwitterPager(api, 'tweets/search/%s/:%s' % (PRODUCT, LABEL),        \n",
    "               {'query':'bounding_box:[-78.8797905618 42.8756162086 -78.8774945908 42.8791227573]',\n",
    "                'maxResults':100\n",
    "               } )\n",
    "\n",
    "list_tweets = []\n",
    "count = 1\n",
    "for item in r.get_iterator(wait=10):\n",
    "    if 'text' in item:\n",
    "        coordinates = item['coordinates'] \n",
    "        tweet_date = item['created_at']\n",
    "        tweet_text = item['text']\n",
    "        tweet_user = item['user']\n",
    "        if 'extended_tweet' in item.keys():\n",
    "            tweet_text = item['extended_tweet']['full_text']\n",
    "        tweet_row = {'long_lat':coordinates,\n",
    "                    'date_utc':tweet_date,\n",
    "                    'full_text':tweet_text,\n",
    "                    'user':tweet_user['screen_name'],\n",
    "                    'location':tweet_user['location'],\n",
    "                    'geoenabled':tweet_user['geo_enabled']}\n",
    "        list_tweets.append(tweet_row)\n",
    "        count = count + 1\n",
    "        print(count,item['text'])\n",
    "    elif 'message' in item and item['code'] == 88:\n",
    "        print('SUSPEND, RATE LIMIT EXCEEDED: %s\\n' % item['message'])\n",
    "        break"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                          date_utc  \\\n",
      "0   Thu Aug 29 23:30:07 +0000 2019   \n",
      "1   Thu Aug 29 10:41:21 +0000 2019   \n",
      "2   Wed Aug 28 20:39:21 +0000 2019   \n",
      "3   Wed Aug 28 20:37:23 +0000 2019   \n",
      "4   Wed Aug 28 20:36:26 +0000 2019   \n",
      "5   Wed Aug 28 20:32:28 +0000 2019   \n",
      "6   Wed Aug 28 15:00:03 +0000 2019   \n",
      "7   Wed Aug 28 10:42:04 +0000 2019   \n",
      "8   Wed Aug 28 06:14:42 +0000 2019   \n",
      "9   Wed Aug 28 05:29:31 +0000 2019   \n",
      "10  Wed Aug 28 04:18:36 +0000 2019   \n",
      "11  Wed Aug 28 02:54:18 +0000 2019   \n",
      "12  Wed Aug 28 02:03:29 +0000 2019   \n",
      "13  Wed Aug 28 00:33:30 +0000 2019   \n",
      "14  Wed Aug 28 00:14:03 +0000 2019   \n",
      "15  Wed Aug 28 00:03:54 +0000 2019   \n",
      "16  Tue Aug 27 22:43:28 +0000 2019   \n",
      "17  Tue Aug 27 22:35:01 +0000 2019   \n",
      "18  Tue Aug 27 16:51:53 +0000 2019   \n",
      "19  Tue Aug 27 12:38:12 +0000 2019   \n",
      "20  Mon Aug 26 01:42:25 +0000 2019   \n",
      "21  Sun Aug 25 22:35:11 +0000 2019   \n",
      "22  Sun Aug 25 21:04:59 +0000 2019   \n",
      "23  Fri Aug 23 21:21:07 +0000 2019   \n",
      "24  Thu Aug 22 14:57:45 +0000 2019   \n",
      "25  Sun Aug 18 19:09:45 +0000 2019   \n",
      "26  Sat Aug 17 23:08:53 +0000 2019   \n",
      "27  Sat Aug 17 21:56:32 +0000 2019   \n",
      "28  Sat Aug 17 21:38:28 +0000 2019   \n",
      "29  Sat Aug 17 21:04:12 +0000 2019   \n",
      "..                             ...   \n",
      "67  Wed Aug 07 00:10:03 +0000 2019   \n",
      "68  Tue Aug 06 23:57:31 +0000 2019   \n",
      "69  Tue Aug 06 23:50:50 +0000 2019   \n",
      "70  Tue Aug 06 23:46:15 +0000 2019   \n",
      "71  Tue Aug 06 23:32:04 +0000 2019   \n",
      "72  Tue Aug 06 23:29:41 +0000 2019   \n",
      "73  Tue Aug 06 23:10:41 +0000 2019   \n",
      "74  Mon Aug 05 18:21:09 +0000 2019   \n",
      "75  Sun Aug 04 05:54:16 +0000 2019   \n",
      "76  Sun Aug 04 05:12:47 +0000 2019   \n",
      "77  Sat Aug 03 17:32:49 +0000 2019   \n",
      "78  Sat Aug 03 17:26:32 +0000 2019   \n",
      "79  Sat Aug 03 14:25:09 +0000 2019   \n",
      "80  Sat Aug 03 13:00:06 +0000 2019   \n",
      "81  Sat Aug 03 05:11:13 +0000 2019   \n",
      "82  Sat Aug 03 04:02:59 +0000 2019   \n",
      "83  Sat Aug 03 02:12:34 +0000 2019   \n",
      "84  Sat Aug 03 00:59:35 +0000 2019   \n",
      "85  Fri Aug 02 23:53:00 +0000 2019   \n",
      "86  Fri Aug 02 23:36:54 +0000 2019   \n",
      "87  Fri Aug 02 22:13:23 +0000 2019   \n",
      "88  Fri Aug 02 21:49:07 +0000 2019   \n",
      "89  Fri Aug 02 21:43:22 +0000 2019   \n",
      "90  Fri Aug 02 18:37:02 +0000 2019   \n",
      "91  Fri Aug 02 18:24:43 +0000 2019   \n",
      "92  Thu Aug 01 21:29:33 +0000 2019   \n",
      "93  Thu Aug 01 14:20:25 +0000 2019   \n",
      "94  Wed Jul 31 22:45:07 +0000 2019   \n",
      "95  Wed Jul 31 22:20:16 +0000 2019   \n",
      "96  Wed Jul 31 12:09:18 +0000 2019   \n",
      "\n",
      "                                            full_text  geoenabled  \\\n",
      "0   #custommade #countdowntoNas #lookformeatCanals...        True   \n",
      "1   Long weekend vibes üëó‚òÄÔ∏èüòäüëª‚ù§Ô∏è @ Buffalo Waterfron...        True   \n",
      "2   @sociald1 @mikeness @ Canalside Live Concert S...        True   \n",
      "3   @floggingmolly @ Canalside Live Concert Series...        True   \n",
      "4   @floggingmolly @ Canalside Live Concert Series...        True   \n",
      "5   #TheDevilMakesThree @thedevilmakes3 djheppel68...        True   \n",
      "6   @buffalolibrary Library on Wheels is at EPIC s...        True   \n",
      "7   Fun in the rain buffalowaterfront \\n@floggingm...        True   \n",
      "8            HAPPINESS BEGINS https://t.co/k5eCtJCsxf        True   \n",
      "9   MAKE AMERICA GREAT AGAIN. I wish I had recorde...        True   \n",
      "10  Great road trip to see Social D! @sociald1  Go...        True   \n",
      "11  When you decide on a whim to buy a ticket to k...        True   \n",
      "12  Concert drunk on a Tuesday night ü§∑üèª‚Äç‚ôÄÔ∏è https:/...        True   \n",
      "13  #floggingmolly @ Canalside Live Concert Series...        True   \n",
      "14  Drinking a Westward by @ThinManBrewery at @lib...        True   \n",
      "15  I'm at Canalside for Social Distortion in Buff...        True   \n",
      "16       #SocialDistortion #FloggingMolly @ canalside        True   \n",
      "17  Free beer= start strong - Drinking a Hayburner...        True   \n",
      "18  I'm at Explore &amp; More - The Ralph C. Wilso...        True   \n",
      "19  I'm at @CanalsideBflo in Buffalo, NY https://t...        True   \n",
      "20  These nachos were real good https://t.co/seaen...        True   \n",
      "21  He hung up the French Fry Skillsets for anothe...        True   \n",
      "22  Summer time fun üíúüíô Talia‚Äôs dress from tinyruff...        True   \n",
      "23  BUFFALOVE ‚ù§Ô∏èüíô‚ù§Ô∏èüíô @ Buffalo Waterfront https://...        True   \n",
      "24                    ~views~ https://t.co/luTmPQeSDw        True   \n",
      "25  #summerday ...\\n\\nüì∏ https://t.co/5Ixl0Ft5H3 ht...        True   \n",
      "26  Closing out our #buffalove #summer day with th...        True   \n",
      "27  Paddle #boating at Canalside! @waterbikesbuff ...        True   \n",
      "28  We are privately chartered this evening but we...        True   \n",
      "29    Canalside on a Saturday https://t.co/hCY6Zh7JDl        True   \n",
      "..                                                ...         ...   \n",
      "67  Incubus! - Drinking a Hayburner by @bigditchbr...        True   \n",
      "68  This girl gets more photo requests than @shark...        True   \n",
      "69             @jjwildechild good stuff at Canalside!        True   \n",
      "70  Even #Constructicons have bring your kid to wo...        True   \n",
      "71  Drinking a Blue Citra by Labatt Brewing Compan...        True   \n",
      "72  I'm at Canalside for Incubus in Buffalo, NY ht...        True   \n",
      "73  üòç (at @CanalsideBflo for Incubus in Buffalo, N...        True   \n",
      "74  Drinking an After-Sesh Ale by @CigarCityBeer a...        True   \n",
      "75  @MikeonMuch Here‚Äôs my best picture from Greg‚Äôs...        True   \n",
      "76  I think that the lighting in this picture real...        True   \n",
      "77  Great to be a part of Hamilton‚Äôs invasion of C...        True   \n",
      "78  Great to be a part of Hamilton‚Äôs invasion of C...        True   \n",
      "79  Great music + warm summer night + fun friends ...        True   \n",
      "80  First and definitely not the last @arkellsmusi...        True   \n",
      "81  For the @MikeonMuch fans out there: here‚Äôs Mik...        True   \n",
      "82  Thank you @arkellsmusic and @Max_Kerman for ma...        True   \n",
      "83  Arkells, again. ü§òüèª‚ù§Ô∏è @ Canalside Live Concert ...        True   \n",
      "84  This. Thank you Buffalo. Arkells. ‚ù§Ô∏è\\n.\\n.\\n.\\...        True   \n",
      "85  Arkells - Drinking a Hayburner by @bigditchbre...        True   \n",
      "86  ‚ö°@arkellsmusic with my faaaave @ouiouiandie! üéµ...        True   \n",
      "87  truly, a great day (yes, my tag is out )|| ‚òÄÔ∏èüåä...        True   \n",
      "88  @arkellsmusic we can wait in this lovely @BufW...        True   \n",
      "89  We made it! A perfect day at Canalside to enjo...        True   \n",
      "90  Looking for a bite to eat this beautiful Frida...        True   \n",
      "91  It's a lovely day at Canalside https://t.co/rF...        True   \n",
      "92  Are you free this Saturday? If not come visit ...        True   \n",
      "93  Don't forget to Get Your Tickets for the @Nell...        True   \n",
      "94  Drinking a Labatt Blue Light Grapefruit by Lab...        True   \n",
      "95  Drinking an 1911 Hard Cider by @1911Spirits at...        True   \n",
      "96  #wcw RMRüíô 17 days til you‚Äôre two. Am I the onl...        True   \n",
      "\n",
      "                    location  \\\n",
      "0                   B-lo, NY   \n",
      "1               Brampton, ON   \n",
      "2                    Buffalo   \n",
      "3                    Buffalo   \n",
      "4                    Buffalo   \n",
      "5                    Buffalo   \n",
      "6                    Buffalo   \n",
      "7          South BUFFALO, NY   \n",
      "8               Syracuse, NY   \n",
      "9                   Hell, NY   \n",
      "10              Vineland, ON   \n",
      "11               Buffalo, NY   \n",
      "12  √úT: 42.956801,-78.875791   \n",
      "13                      None   \n",
      "14                 Bronx, NY   \n",
      "15          Niagara Falls NY   \n",
      "16              Fairport, NY   \n",
      "17                   Buffalo   \n",
      "18                   The 716   \n",
      "19              Franklin, MA   \n",
      "20               Western, NY   \n",
      "21                      None   \n",
      "22              Disney World   \n",
      "23             United States   \n",
      "24               Hamburg, NY   \n",
      "25        Niagara University   \n",
      "26               Buffalo, NY   \n",
      "27               Buffalo, NY   \n",
      "28               Buffalo, NY   \n",
      "29    Town of Tonawanda , NY   \n",
      "..                       ...   \n",
      "67               Buffalo, NY   \n",
      "68                      B-Lo   \n",
      "69                        NY   \n",
      "70      43.187391,-79.225681   \n",
      "71                   Buffalo   \n",
      "72          Niagara Falls NY   \n",
      "73      Rochester, New York    \n",
      "74                      None   \n",
      "75                      None   \n",
      "76                      None   \n",
      "77       Woodbridge, Ontario   \n",
      "78       Woodbridge, Ontario   \n",
      "79        Buffalo, New York    \n",
      "80                       WNY   \n",
      "81                      None   \n",
      "82           Ontario, Canada   \n",
      "83                      None   \n",
      "84              Ancaster, ON   \n",
      "85           Orchard Park NY   \n",
      "86              Syracuse, NY   \n",
      "87         williamsville, ny   \n",
      "88          Thorold, Ontario   \n",
      "89       Woodbridge, Ontario   \n",
      "90               Buffalo, NY   \n",
      "91               Buffalo, NY   \n",
      "92               Buffalo, NY   \n",
      "93             International   \n",
      "94                Buffalo ny   \n",
      "95                Buffalo ny   \n",
      "96               Buffalo, NY   \n",
      "\n",
      "                                             long_lat             user  \n",
      "0   {'type': 'Point', 'coordinates': [-78.878525, ...        my1sttime  \n",
      "1   {'type': 'Point', 'coordinates': [-78.87860439...      KomalMoondi  \n",
      "2   {'type': 'Point', 'coordinates': [-78.878525, ...        pattyla16  \n",
      "3   {'type': 'Point', 'coordinates': [-78.878525, ...        pattyla16  \n",
      "4   {'type': 'Point', 'coordinates': [-78.878525, ...        pattyla16  \n",
      "5   {'type': 'Point', 'coordinates': [-78.878525, ...        pattyla16  \n",
      "6                                                None       sampurpora  \n",
      "7   {'type': 'Point', 'coordinates': [-78.87860439...    annieruok1975  \n",
      "8                                                None     ClaryJessica  \n",
      "9   {'type': 'Point', 'coordinates': [-78.87860439...     DaniAllNight  \n",
      "10  {'type': 'Point', 'coordinates': [-78.878525, ...        wine_gems  \n",
      "11  {'type': 'Point', 'coordinates': [-78.878525, ...        namcopunk  \n",
      "12                                               None           suzy87  \n",
      "13  {'type': 'Point', 'coordinates': [-78.878525, ...        TBobTarpy  \n",
      "14  {'type': 'Point', 'coordinates': [-78.8797, 42...         BXdannyZ  \n",
      "15  {'type': 'Point', 'coordinates': [-78.87882603...           tmajic  \n",
      "16                                               None         RickBorn  \n",
      "17  {'type': 'Point', 'coordinates': [-78.8788, 42...        pattyla16  \n",
      "18  {'type': 'Point', 'coordinates': [-78.877703, ...   FancyTitleHere  \n",
      "19  {'type': 'Point', 'coordinates': [-78.87882603...      PaulM138666  \n",
      "20                                               None         crimtina  \n",
      "21  {'type': 'Point', 'coordinates': [-78.87976946...    SeanCrotty134  \n",
      "22  {'type': 'Point', 'coordinates': [-78.87860439...   sarahhhmarie27  \n",
      "23  {'type': 'Point', 'coordinates': [-78.87860439...   realmarkjansen  \n",
      "24                                               None    crozier_agent  \n",
      "25  {'type': 'Point', 'coordinates': [-78.8793511,...          LNUGuru  \n",
      "26                                               None  ScottMPatterson  \n",
      "27                                               None  ScottMPatterson  \n",
      "28  {'type': 'Point', 'coordinates': [-78.87860439...        GLCruises  \n",
      "29                                               None   campaignconrad  \n",
      "..                                                ...              ...  \n",
      "67  {'type': 'Point', 'coordinates': [-78.8788, 42...        StevieZ23  \n",
      "68                                               None          lissmoe  \n",
      "69                                               None        grooveace  \n",
      "70  {'type': 'Point', 'coordinates': [-78.878525, ...         soresage  \n",
      "71  {'type': 'Point', 'coordinates': [-78.8788, 42...        pattyla16  \n",
      "72  {'type': 'Point', 'coordinates': [-78.87882603...           tmajic  \n",
      "73  {'type': 'Point', 'coordinates': [-78.87882603...   danielleriley3  \n",
      "74  {'type': 'Point', 'coordinates': [-78.8797, 42...         gbress70  \n",
      "75                                               None       Karen21093  \n",
      "76                                               None       Karen21093  \n",
      "77  {'type': 'Point', 'coordinates': [-78.878525, ...          Agnew66  \n",
      "78  {'type': 'Point', 'coordinates': [-78.878525, ...          Agnew66  \n",
      "79                                               None  GretchenNichols  \n",
      "80                                               None     BMazzariello  \n",
      "81                                               None       Karen21093  \n",
      "82                                               None      LaurenVysee  \n",
      "83  {'type': 'Point', 'coordinates': [-78.878525, ...       danaconnor  \n",
      "84  {'type': 'Point', 'coordinates': [-78.878525, ...  Queenvanderveen  \n",
      "85  {'type': 'Point', 'coordinates': [-78.8788, 42...  BuffaloBeerGeek  \n",
      "86  {'type': 'Point', 'coordinates': [-78.87882603...       ofrassilon  \n",
      "87  {'type': 'Point', 'coordinates': [-78.87860439...  marissa_mccabe_  \n",
      "88                                               None   timlewisgeddes  \n",
      "89  {'type': 'Point', 'coordinates': [-78.878525, ...          Agnew66  \n",
      "90                                               None   BrycesIceCream  \n",
      "91                                               None  HeatherHenders1  \n",
      "92                                               None           ubseds  \n",
      "93  {'type': 'Point', 'coordinates': [-78.878525, ...       1K_Simmons  \n",
      "94  {'type': 'Point', 'coordinates': [-78.8788, 42...         skidog85  \n",
      "95  {'type': 'Point', 'coordinates': [-78.8788, 42...         skidog85  \n",
      "96  {'type': 'Point', 'coordinates': [-78.87860439...          LonnaLu  \n",
      "\n",
      "[97 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "df = pd.DataFrame(list_tweets)\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_json('190830_30Day_Test.json', orient='records')\n",
    "df.to_csv('190830_30Day_Test.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## DEPRECIATED; DO NOT RUN\n",
    "\n",
    "list_tweets = []\n",
    "next = None\n",
    "web_request_count = 0\n",
    "\n",
    "r = api.request('tweets/search/%s/:%s' % (PRODUCT, LABEL),        \n",
    "               {'query':'bounding_box:[-74.135353 40.635674 -73.801643 40.893625]',\n",
    "                'next': next # This has to be commented out for the first web request\n",
    "               })\n",
    "\n",
    "print('r.status_code: ', r.status_code)\n",
    "print('web_request_count: ', web_request_count)\n",
    "web_request_count += 1\n",
    "results = r.json()['results']\n",
    "for tweet in results:\n",
    "    coordinates = tweet['coordinates'] \n",
    "    tweet_date = tweet['created_at']\n",
    "    tweet_text = tweet['text']\n",
    "    tweet_user = tweet['user']\n",
    "    if 'extended_tweet' in tweet.keys():\n",
    "        tweet_text = tweet['extended_tweet']['full_text']\n",
    "    tweet_row = {'long_lat':coordinates,\n",
    "                'date_utc':tweet_date,\n",
    "                'full_text':tweet_text,\n",
    "                'user':tweet_user['screen_name'],\n",
    "                'location':tweet_user['location'],\n",
    "                'geoenabled':tweet_user['geo_enabled']}\n",
    "    list_tweets.append(tweet_row)\n",
    "df = pd.DataFrame(list_tweets)\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## DEPRECIATED; DO NOT RUN\n",
    "df.to_json('Test5_Loc_20180829.json', orient='records')\n",
    "df.to_csv('Test5_Loc_20180829.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## DEPRECIATED; DO NOT RUN\n",
    "\n",
    "while next is not None:\n",
    "       r = api.request('tweets/search/%s/:%s' % (PRODUCT, LABEL),        \n",
    "               {'query':'bounding_box:[-78.8797476464 42.8766147304 -78.8771083527 42.8791735224]',\n",
    "                'toDate':'201812310000',\n",
    "                'fromDate':'201801010000',\n",
    "                'maxResults':'500',\n",
    "                'next': next\n",
    "                })\n",
    "       print('r.status_code: ', r.status_code)\n",
    "       next = r.json()['next']\n",
    "       print('web_request_count: ', web_request_count)\n",
    "       web_request_count += 1\n",
    "       results = r.json()['results']\n",
    "       for tweet in results:\n",
    "           coordinates = tweet['coordinates']['coordinates']\n",
    "           tweet_date = tweet['created_at']\n",
    "           tweet_text = tweet['text']\n",
    "           tweet_user = tweet['user']\n",
    "           if 'extended_tweet' in tweet.keys():\n",
    "               tweet_text = tweet['extended_tweet']['full_text']\n",
    "           tweet_row = {'long_lat':coordinates,\n",
    "                        'date_utc':tweet_date,\n",
    "                        'full_text':tweet_text,\n",
    "                        'user':tweer_user}\n",
    "           list_tweets.append(tweet_row)\n",
    "       df = pd.DataFrame(list_tweets)\n",
    "           \n",
    "       df.to_json('tweets_df_buffalo_25mi_18.json', orient='records')\n",
    "       df.to_csv('tweets_df_buffalo_25mi_18.csv', orient='records')\n",
    "       time.sleep(2.1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
